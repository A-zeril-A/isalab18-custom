<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Trip Details Wizard Form View -->
    <record id="view_business_trip_details_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.details.wizard.form</field>
        <field name="model">business.trip.details.wizard</field>
        <field name="arch" type="xml">
            <form string="Edit Trip Details">
                <sheet>
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="destination" required="1"/>
                        <field name="purpose" required="1"/>
                        <field name="is_hourly_trip" />
                    </group>
                    
                    <group>
                        <group string="Trip Dates" invisible="is_hourly_trip == True">
                            <field name="travel_start_date" required="1"/>
                            <field name="travel_end_date" required="1" readonly="is_hourly_trip == True"/>
                        </group>
                        <group string="Same Day Trip" invisible="is_hourly_trip == False">
                            <field name="travel_start_date" required="1" string="Date"/>
                            <field name="travel_start_time" widget="float_time"/>
                            <field name="travel_end_time" widget="float_time"/>
                        </group>
                    </group>
                </sheet>
                <footer>
                    <button name="action_save" string="Save" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Cost Estimation Wizard Form View -->
    <record id="view_business_trip_cost_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.cost.wizard.form</field>
        <field name="model">business.trip.cost.wizard</field>
        <field name="arch" type="xml">
            <form string="Cost Estimation">
                <sheet>
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="expected_cost" required="1"/>
                        <field name="currency_id" options="{'no_create': True, 'no_open': True}" required="1"/>
                        <field name="estimation_comments" placeholder="Enter any notes about this cost estimation..."/>
                    </group>
                </sheet>
                <footer>
                    <button name="action_save" string="Save" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Expense Submission Wizard Form View -->
    <record id="view_business_trip_expense_submission_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.expense.submission.wizard.form</field>
        <field name="model">business.trip.expense.submission.wizard</field>
        <field name="arch" type="xml">
            <form string="Submit Travel Expenses">
                <sheet>
                    <div class="alert alert-info alert-link">
                        <i class="fa fa-info-circle mr-2" title="Information"></i>
                        <span>If you had no additional expenses during your trip, please check the "No Expenses to Submit" box.</span>
                    </div>
                    
                    <!-- Upload requirement notice for resubmissions -->
                    <div class="alert alert-warning alert-link" invisible="requires_new_attachments == False or expense_attachment_ids != []">
                        <i class="fa fa-exclamation-triangle mr-2" title="Warning"></i>
                        <span><strong>Required:</strong> You must upload new receipt attachments before submitting. Comments alone are not sufficient for resubmissions.</span>
                    </div>
                    
                    <!-- Upload in progress notice -->
                    <div class="alert alert-info alert-link" invisible="is_uploading == False">
                        <i class="fa fa-spinner fa-spin mr-2" title="Uploading"></i>
                        <span><strong>Uploading files...</strong> Please wait for the upload to complete before submitting.</span>
                    </div>
                    
                    <!-- Validation status indicator for first-time submissions -->
                    <div class="alert alert-warning alert-link" invisible="can_submit == True or has_no_expenses == True or is_resubmission == True">
                        <i class="fa fa-exclamation-triangle mr-2" title="Validation"></i>
                        <span>Please attach receipts or add comments to explain your expenses before submitting.</span>
                    </div>
                    
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="is_uploading" invisible="1"/>
                        <field name="can_submit" invisible="1"/>
                        <field name="is_resubmission" invisible="1"/>
                        <field name="requires_new_attachments" invisible="1"/>
                        <field name="has_no_expenses" />
                        <field name="expense_total" required="1" readonly="has_no_expenses == True"/>
                        <field name="currency_id" readonly="1" force_save="1"/>
                        <field name="expense_comments" placeholder="Enter any comments regarding the travel expenses (especially if you don't have receipts)..."/>
                        <field name="expense_attachment_ids" widget="many2many_binary" string="Attach Receipts" 
                               required="expense_total > 0" 
                               help="Upload your receipts here. Multiple files are supported."/>
                    </group>
                </sheet>
                <footer>
                    <button name="action_apply" string="Submit" type="object" 
                            class="btn-primary" data-hotkey="q"
                            invisible="can_submit == False"/>
                    <button name="dummy_disabled_button" string="Submit (Complete Required Fields)" type="button" 
                            class="btn-secondary" disabled="1"
                            invisible="can_submit == True"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Return Comment Wizard Form View -->
    <record id="view_business_trip_return_comment_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.return.comment.wizard.form</field>
        <field name="model">business.trip.return.comment.wizard</field>
        <field name="arch" type="xml">
            <form string="Return with Comments">
                <sheet>
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="return_comments" required="1" placeholder="Enter comments for returning the request..."/>
                    </group>
                </sheet>
                <footer>
                    <button name="action_apply" string="Return Request" type="object" class="btn-primary" data-hotkey="q"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Rejection Wizard Form View -->
    <record id="view_business_trip_rejection_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.rejection.wizard.form</field>
        <field name="model">business.trip.rejection.wizard</field>
        <field name="arch" type="xml">
            <form string="Reject Business Trip Request">
                <sheet>
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="rejection_reason" required="1"/>
                        <field name="rejection_comment" placeholder="Enter details for the rejection (optional)..."/>
                    </group>
                </sheet>
                <footer>
                    <button name="action_apply" string="Reject Request" type="object" class="btn-danger" data-hotkey="q"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Expense Return Comment Wizard Form View -->
    <record id="view_business_trip_expense_return_comment_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.expense.return.comment.wizard.form</field>
        <field name="model">business.trip.expense.return.comment.wizard</field>
        <field name="arch" type="xml">
            <form string="Return Travel Expenses">
                <sheet>
                    <div class="alert alert-warning alert-link">
                        <i class="fa fa-exclamation-triangle mr-2" title="Warning"></i>
                        <span>The travel expenses will be returned to the employee for revision. Please provide clear feedback on what needs to be corrected.</span>
                    </div>
                    <group>
                        <field name="trip_id" invisible="1"/>
                        <field name="expense_return_comments" required="1" placeholder="Explain what changes are needed in the expense report..."/>
                    </group>
                </sheet>
                <footer>
                    <button name="action_apply" string="Return Travel Expenses" type="object" class="btn-warning" data-hotkey="q"/>
                    <button string="Cancel" class="btn-secondary" special="cancel" data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Wizard for Assigning Organizer and Budget -->
    <record id="view_business_trip_assign_organizer_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.assign.organizer.wizard.form</field>
        <field name="model">business.trip.assign.organizer.wizard</field>
        <field name="arch" type="xml">
            <form string="Assign Organizer and Budget">
                <group>
                    <field name="trip_id" invisible="1"/>
                    <field name="manager_id" readonly="1" options="{'no_open': True}"/>
                    <field name="manager_max_budget" placeholder="Leave empty to assign organizer without setting budget"/>
                    <field name="organizer_id" options="{'no_create': True, 'no_open': True}" context="{'active_test': False}"/>
                    <field name="assignment_comments" placeholder="Enter any initial comments or instructions for the organizer..."/>
                </group>
                <footer>
                    <button name="action_save_organizer_only" string="Save (Preliminary)" type="object" class="btn-primary"
                            help="Assign organizer without finalizing budget. Budget will be determined later after discussion."/>
                    <button name="action_assign_organizer_and_budget" string="Save &amp; Confirm" type="object" class="btn-success"
                            help="Save with budget and organizer, finalizing the assignment."/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action for Trip Plan Item Attachments -->
    <record id="attachment_action" model="ir.actions.act_window">
        <field name="name">Attachments</field>
        <field name="res_model">ir.attachment</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="domain">[('res_model', '=', 'business.trip.plan.line.item'), ('res_id', '=', active_id)]</field>
        <field name="context">{'default_res_model': 'business.trip.plan.line.item', 'default_res_id': active_id}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add attachments for this plan item
            </p>
        </field>
    </record>

    <!-- Business Trip Project Selection Wizard -->
    <record id="view_business_trip_project_selection_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.project.selection.wizard.form</field>
        <field name="model">business.trip.project.selection.wizard</field>
        <field name="arch" type="xml">
            <form string="Select Project for Business Trip">
                <div class="alert alert-info alert-link" style="margin: 16px 0;">
                    <h4>Project Selection for Standalone Business Trip</h4>
                    <p>Please select the project for which you are requesting this business trip. 
                       All projects are shown. A task will be automatically 
                       created in the selected project for tracking purposes.</p>
                </div>
                <group>
                    <field name="project_id" placeholder="Select a project for your business trip..." 
                           required="1" string="Select Project"/>
                </group>
                <footer>
                    <button name="action_create_trip_with_project" type="object" string="Continue with Selected Project" class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action for Project Selection Wizard -->
    <record id="action_business_trip_project_selection_wizard" model="ir.actions.act_window">
        <field name="name">Select Project for Business Trip</field>
        <field name="res_model">business.trip.project.selection.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="view_id" ref="view_business_trip_project_selection_wizard_form"/>
    </record>

    <!-- Business Trip Organizer Plan Wizard -->
    <record id="view_business_trip_organizer_plan_wizard_form" model="ir.ui.view">
        <field name="name">business.trip.organizer.plan.wizard.form</field>
        <field name="model">business.trip.organizer.plan.wizard</field>
        <field name="arch" type="xml">
            <form string="Edit Trip Plan">
                <sheet>
                    <div class="alert alert-info alert-link" style="margin-bottom: 10px;">
                        <i class="fa fa-info-circle mr-2" title="Planning Guide"></i>
                        <span>To create a travel plan:</span>
                        <ul>
                            <li><strong>Either add travel items OR provide overall plan details in the Additional Notes tab</strong></li>
                            <li>You can add items without cost or enter the total cost manually</li>
                            <li>Use the wide variety of predefined item types or create your own custom items</li>
                            <li>Add detailed information like booking references, carrier details, and travel times</li>
                            <li>Specify payment methods and cost status for each item</li>
                            <li>Upload documents related to each item by clicking on the attachment icon on the right side of the row</li>
                            <li>Upload tickets and documents needed by the employee in the "Employee Documents" tab</li>
                        </ul>
                    </div>
                    
                    <!-- Budget information -->
                    <div class="row mt-2 mb-4">
                        <div class="col-md-4">
                            <div class="h5 d-flex align-items-center">
                                <span class="mr-2">Max Budget:</span>
                                <span class="badge badge-info">
                                    <field name="manager_max_budget" widget="monetary" options="{'currency_field': 'currency_id'}" class="h5"/>
                                </span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="h5 d-flex align-items-center">
                                <span class="mr-2">Total Planned:</span>
                                <span t-attf-class="badge {{over_budget ? 'badge-danger' : 'badge-success'}}">
                                    <field name="organizer_planned_cost" widget="monetary" options="{'currency_field': 'currency_id'}" class="h5" readonly="1"/>
                                </span>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="h5 d-flex align-items-center">
                                <span class="mr-2">Difference:</span>
                                <span t-attf-class="badge {{budget_difference >= 0 ? 'badge-success' : 'badge-danger'}}">
                                    <field name="budget_difference" widget="monetary" options="{'currency_field': 'currency_id'}" class="h5"/>
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Manual cost option -->
                    <div class="row mb-4 mt-2">
                        <div class="col-12">
                            <div class="custom-control custom-switch">
                                <field name="manual_cost_entry" widget="boolean_toggle" class="mr-2"/>
                                <label for="manual_cost_entry">Enter Total Cost Manually</label>
                            </div>
                        </div>
                        <div class="col-md-4" invisible="manual_cost_entry == False">
                            <div class="mt-2">
                                <label for="manual_planned_cost" class="mr-2">Manual Total Cost:</label>
                                <field name="manual_planned_cost" widget="monetary" options="{'currency_field': 'currency_id'}" class="oe_inline"/>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Hidden fields -->
                    <field name="trip_id" invisible="1"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="over_budget" invisible="1"/>
                    
                    <!-- Travel Items -->
                    <notebook>
                        <page string="Travel Plan Items">
                            <div class="alert alert-info alert-link" style="margin-bottom: 10px;">
                                <i class="fa fa-info-circle mr-2" title="Information"></i>
                                <span><strong>How to use this tab:</strong> Add your travel items here by clicking "Add a new item". Enter all required information for each item type.</span>
                                <ul class="mt-1 mb-0">
                                    <li>For <strong>Air Travel</strong>, <strong>Train</strong> and <strong>Bus</strong>: "From", "To" and date are required fields</li>
                                    <li>For <strong>Accommodation</strong>: Type and number of nights are required</li>
                                    <li>Use the detailed form view for additional item options by clicking on a row after saving it</li>
                                </ul>
                            </div>
                            
                            <!-- Item summary -->
                            <div class="row mt-2 mb-3">
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center">
                                        <span class="mr-2">Transport:</span>
                                        <span class="badge badge-info">
                                            <field name="transport_count"/> items
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center">
                                        <span class="mr-2">Accommodation:</span>
                                        <span class="badge badge-info">
                                            <field name="accommodation_count"/> items
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex align-items-center">
                                        <span class="mr-2">Other:</span>
                                        <span class="badge badge-info">
                                            <field name="other_count"/> items
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <field name="plan_item_ids" context="{'default_item_date': context.get('default_item_date')}" editable="bottom">
                                <list editable="bottom" create="1" delete="1" decoration-info="cost_status=='estimated'" decoration-success="cost_status=='confirmed'" decoration-muted="cost_status=='to_reimburse'">
                                    <control>
                                        <create string="Add a new item"/>
                                        <field name="item_type" invisible="1"/>
                                    </control>
                                    <field name="item_type" widget="selection" required="1"/>
                                    <field name="custom_type" column_invisible="True" invisible="item_type != 'custom'" required="item_type == 'custom'"/>
                                    <field name="description" required="1"/>
                                    <field name="item_date" required="1"/>
                                    <field name="direction" widget="selection" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_car', 'transport_taxi', 'transport_other')"/>
                                    <field name="from_location" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_taxi', 'transport_other')"
                                           required="item_type in ('transport_air', 'transport_train', 'transport_bus')"/>
                                    <field name="to_location" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_taxi', 'transport_other')"
                                           required="item_type in ('transport_air', 'transport_train', 'transport_bus')"/>
                                    <field name="accommodation_type" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('accommodation', 'accommodation_airbnb')"
                                           required="item_type in ('accommodation', 'accommodation_airbnb')"/>
                                    <field name="nights" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('accommodation', 'accommodation_airbnb')"
                                           required="item_type in ('accommodation', 'accommodation_airbnb')"/>
                                    <field name="carrier" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus')"/>
                                    <field name="reference_number" 
                                           column_invisible="parent.plan_item_ids == []" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'accommodation', 'accommodation_airbnb')"/>
                                    <field name="cost" sum="Total"/>
                                    <field name="payment_method" column_invisible="parent.plan_item_ids == []"/>
                                    <field name="cost_status" column_invisible="parent.plan_item_ids == []"/>
                                    <field name="currency_id" invisible="1"/>
                                    <button name="%(attachment_action)d" type="action" 
                                            icon="fa-paperclip" 
                                            title="Attachments"
                                            context="{'default_res_model': 'business.trip.plan.line.item', 'default_res_id': id}"
                                            invisible="id == False"/>
                                    <button name="edit_item" string="Edit Details" type="object" class="btn btn-sm btn-link" 
                                            invisible="id == False" 
                                            icon="fa-edit"/>
                                </list>
                                <form>
                                    <sheet>
                                        <div class="oe_title">
                                            <h1>
                                                <field name="description" placeholder="Description..."/>
                                            </h1>
                                        </div>
                                        
                                        <!-- Item type selection with better visibility -->
                                        <div class="alert alert-info alert-link">
                                            <strong>Item Type:</strong> 
                                            <field name="item_type" widget="radio" options="{'horizontal': true}" style="margin-left: 10px;"/>
                                            <field name="custom_type" invisible="item_type != 'custom'" required="item_type == 'custom'" placeholder="Specify custom type..." style="margin-left: 10px;"/>
                                        </div>
                                        
                                        <group>
                                            <group>
                                                <field name="item_date" required="1"/>
                                                <!-- Show direction prominently for transport types -->
                                                <field name="direction" widget="selection" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_taxi', 'transport_other')" required="item_type in ('transport_air', 'transport_train', 'transport_bus', 'transport_taxi')"/>
                                            </group>
                                            <group>
                                                <field name="cost"/>
                                                <field name="cost_status" widget="selection"/>
                                                <field name="payment_method" widget="selection"/>
                                                <field name="currency_id" invisible="1"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Type-specific detail sections with better organization -->
                                        
                                        <!-- Transport common fields (only visible for transport types) -->
                                        <group string="Transport Details" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_car', 'transport_taxi', 'transport_other')">
                                            <group>
                                                <field name="from_location" placeholder="Origin location" required="item_type in ('transport_air', 'transport_train', 'transport_bus')"/>
                                                <field name="to_location" placeholder="Destination location" required="item_type in ('transport_air', 'transport_train', 'transport_bus')"/>
                                            </group>
                                            <group>
                                                <field name="carrier" placeholder="e.g. Airline, Train Company" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_car')"/>
                                                <field name="reference_number" placeholder="Booking reference, ticket number" invisible="item_type not in ('transport_air', 'transport_train', 'transport_bus', 'transport_car', 'accommodation', 'accommodation_airbnb')"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Flight specific fields -->
                                        <group string="Flight Specific Details" invisible="item_type != 'transport_air'">
                                            <group>
                                                <label for="departure_time" string="Flight Times"/>
                                                <div class="o_row">
                                                    <field name="departure_time" widget="float_time" placeholder="Dep. Time" class="oe_inline"/>
                                                    <span class="mx-2">→</span>
                                                    <field name="arrival_time" widget="float_time" placeholder="Arr. Time" class="oe_inline"/>
                                                </div>
                                                <field name="travel_class"/>
                                            </group>
                                            <group>
                                                <field name="flight_number_widget" string="Flight Number" placeholder="e.g. EK789"/>
                                                <field name="terminal_info_widget" string="Terminal/Gate" placeholder="e.g. Terminal 2, Gate B12"/>
                                                <field name="layovers_widget" string="Layovers" placeholder="e.g. Istanbul (2h)"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Train/Bus specific fields -->
                                        <group string="Train/Bus Specific Details" invisible="item_type not in ('transport_train', 'transport_bus')">
                                            <group>
                                                <label for="departure_time" string="Departure/Arrival Times"/>
                                                <div class="o_row">
                                                    <field name="departure_time" widget="float_time" placeholder="Dep. Time" class="oe_inline"/>
                                                    <span class="mx-2">→</span>
                                                    <field name="arrival_time" widget="float_time" placeholder="Arr. Time" class="oe_inline"/>
                                                </div>
                                                <field name="travel_class"/>
                                            </group>
                                            <group>
                                                <!-- Placeholder for future train/bus specific fields -->
                                            </group>
                                        </group>
                                        
                                        <!-- Accommodation fields -->
                                        <group string="Accommodation Details" invisible="item_type not in ('accommodation', 'accommodation_airbnb')">
                                            <group>
                                                <field name="accommodation_type" widget="selection" required="1"/>
                                                <field name="nights" required="1"/>
                                            </group>
                                            <group>
                                                <field name="check_in_time_widget" string="Check-in Time" placeholder="e.g. 15:00"/>
                                                <field name="check_out_time_widget" string="Check-out Time" placeholder="e.g. 11:00"/>
                                                <field name="room_type_widget" string="Room Type" placeholder="e.g. Standard Double, Suite"/>
                                                <field name="address_widget" string="Address" placeholder="Full accommodation address"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Meals fields -->
                                        <group string="Meals Details" invisible="item_type not in ('meals', 'meals_per_diem')">
                                            <group>
                                                <field name="meal_type_widget" string="Meal Type" placeholder="e.g. Breakfast, Lunch, Dinner"/>
                                                <field name="allowance_rate_widget" string="Per Diem Rate" invisible="item_type != 'meals_per_diem'" placeholder="Daily rate amount"/>
                                            </group>
                                            <group>
                                                <field name="is_reimbursable"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Conference fields -->
                                        <group string="Conference/Event Details" invisible="item_type != 'conference'">
                                            <group>
                                                <field name="event_name_widget" string="Event Name" placeholder="Conference/Event name"/>
                                                <field name="location_widget" string="Location" placeholder="Conference venue and location"/>
                                                <field name="event_times_widget" string="Event Times" placeholder="e.g. 9:00-17:00"/>
                                            </group>
                                            <group>
                                                <field name="is_reimbursable"/>
                                            </group>
                                        </group>
                                        
                                        <!-- Other expenses fields -->
                                        <group string="Other Expense Details" invisible="item_type not in ('visa_fee', 'parking', 'insurance', 'internet', 'translation', 'entertainment', 'shopping', 'currency_exchange', 'other', 'custom')">
                                            <group>
                                                <field name="is_reimbursable"/>
                                            </group>
                                            <group>
                                                <!-- Placeholder for future expense-specific fields -->
                                            </group>
                                        </group>
                                        
                                        <!-- Notes and attachments for all types -->
                                        <group string="Notes">
                                            <field name="notes" nolabel="1" placeholder="Add any additional details for this item..."/>
                                        </group>
                                        <group string="Attachments">
                                            <field name="attachment_ids" widget="many2many_binary" string="Attach Documents"/>
                                        </group>
                                        
                                        <field name="item_data_json" invisible="1"/>
                                    </sheet>
                                </form>
                            </field>
                            
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="cost_summary">
                                <field name="organizer_planned_cost" widget="monetary" options="{'currency_field': 'currency_id'}" 
                                       class="oe_subtotal_footer_separator" readonly="manual_cost_entry == True"/>
                            </group>
                        </page>
                        <page string="Additional Notes">
                            <div class="alert alert-warning alert-link">
                                <i class="fa fa-exclamation-triangle mr-2" title="Warning"></i>
                                <span><strong>Important:</strong> If you don't add any travel items in the "Travel Plan Items" tab, you MUST provide detailed trip plan information here. This field was previously required for all plans.</span>
                            </div>
                            <field name="organizer_trip_plan_details" placeholder="Enter detailed travel plan information here if you are not using the itemized entry in the Travel Plan Items tab. Include transportation details, accommodation arrangements, and any other relevant information..."/>
                            <field name="organizer_attachments_ids" widget="many2many_binary" string="Additional Attachments" groups="custom_business_trip_management.group_business_trip_organizer,base.group_system"/>
                        </page>
                        <page string="Employee Documents">
                            <div class="alert alert-warning alert-link">
                                <i class="fa fa-ticket mr-2"></i>
                                <span>In this section, upload tickets, receipts, and other documents related to the trip.</span>
                            </div>
                            <field name="employee_documents_ids" widget="many2many_binary" string="Tickets and Trip Documents" />
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="action_save_plan" string="Save" type="object" class="btn-primary"/>
                    <button name="action_save_and_confirm" string="Save &amp; Confirm" type="object" class="btn-success"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action for Assign Organizer and Budget Wizard -->
    <!-- This action is usually called from the formio.form model method -->
    <!-- <record id="action_business_trip_assign_organizer_wizard" model="ir.actions.act_window">
        <field name="name">Assign Organizer and Budget</field>
        <field name="res_model">business.trip.assign.organizer.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record> -->
</odoo>
